    <!DOCTYPE html>
<html lang="zh-cn">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="author" content="alenstar">
		<meta name="description" content="alenstar blog">
		<meta name="generator" content="Hugo 0.36.1" />
		<title>Linux 小技巧 &middot; alenstar blog</title>
		<link rel="shortcut icon" href="https://alenstar.github.io/images/favicon.ico">
		<link rel="stylesheet" href="https://alenstar.github.io/css/style.css">
		<link rel="stylesheet" href="https://alenstar.github.io/css/highlight.css">
		

		
		<link rel="stylesheet" href="https://alenstar.github.io/css/font-awesome.min.css">
		

		
        
        
        
		
	</head>

    <body>
	<div class="body-box">
       <nav class="main-nav">
	
	
		<a href='https://alenstar.github.io/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://alenstar.github.io/post'>Archive</a>
	<a href='https://alenstar.github.io/tags'>Tags</a>
	<a href='https://alenstar.github.io/about'>About</a>

	

	
</nav>


        <section id="wrapper">
            <article class="post">
                <header>
                    <h1>
                        Linux 小技巧
                    </h1>
                    <h2 class="headline">
                    Aug 5, 2017 13:00
                    · 802 words
                    · 2 minutes read
                      <span class="tags">
                      
                      
                          
                              <a href="https://alenstar.github.io/tags/linux">linux</a>
                          
                              <a href="https://alenstar.github.io/tags/bash">bash</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                <section id="post-body">
                    <ol>
<li>有道词典(Python3)</li>
</ol>

<pre><code># 使用命令别名
alias youdao='python3 /opt/skill/youdao.py'
</code></pre>

<ol>
<li>文件内部搜索(自动递归子目录, 忽略二进制文件)</li>
</ol>

<pre><code># 命令别名 findstr for string search within file
alias findstr='find `pwd` -type f |xargs grep -s -i -n --binary-files=without-match'
</code></pre>

<ol>
<li>Shell 重定向</li>
</ol>

<blockquote>
<p>0表示标准输入<br />
1表示标准输出<br />
2表示标准错误输出<br />
默认为标准输出重定向，与 1&gt; 相同<br />
2&gt;&amp;1 意思是把 标准错误输出 重定向到 标准输出.<br />
&amp;&gt;file 意思是把 标准输出 和 标准错误输出 都重定向到文件file中</p>
</blockquote>

<ol>
<li>Docker 镜像加速</li>
</ol>

<p>修改(不存在则创建) /etc/docker/daemon.json 文件并添加上 registry-mirrors 键值。</p>

<pre><code>{
  &quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;]
}
</code></pre>

<p>重启 Docker</p>

<pre><code>systemctl daemon-reload
systemctl restart docker
</code></pre>

<ol>
<li>npm 镜像加速</li>
</ol>

<p>安装 cnpm</p>

<pre><code>npm install -g cnpm --registry=https://registry.npm.taobao.org
</code></pre>

<p>或者使用别名</p>

<pre><code>alias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \
--cache=$HOME/.npm/.cache/cnpm \
--disturl=https://npm.taobao.org/dist \
--userconfig=$HOME/.cnpmrc&quot;

# Or alias it in .bashrc or .zshrc
$ echo '\n#alias for cnpm\nalias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \
  --cache=$HOME/.npm/.cache/cnpm \
  --disturl=https://npm.taobao.org/dist \
  --userconfig=$HOME/.cnpmrc&quot;' &gt;&gt; ~/.zshrc &amp;&amp; source ~/.zshrc
</code></pre>

<p>使用 cnpm 替代 npm</p>

<ol>
<li>clang-formt 配置</li>
</ol>

<pre><code>#基于那个配置文件
BasedOnStyle: LLVM
#指针的*的挨着哪边
PointerAlignment: Right
#缩进宽度
IndentWidth: 4
# 连续的空行保留几行
MaxEmptyLinesToKeep: 1
# 在 @property 后面添加空格, \@property (readonly) 而不是 \@property(readonly).
ObjCSpaceAfterProperty: true
# OC block后面的缩进
ObjCBlockIndentWidth: 4
# 是否允许短方法单行
AllowShortFunctionsOnASingleLine: true
# 是否允许短if单行 If true, if (a) return; 可以放到同一行
AllowShortIfStatementsOnASingleLine: true
#注释对齐
AlignTrailingComments: true
# 换行的时候对齐操作符
#AlignOperands: true
# 中括号两边空格 [] 
SpacesInSquareBrackets: true
# 小括号两边添加空格
SpacesInParentheses : true
#多行声明语句按照=对齐
AlignConsecutiveDeclarations: true
#连续的赋值语句以 = 为中心对齐
AlignConsecutiveAssignments: true
#等号两边的空格
SpaceBeforeAssignmentOperators: true
# 容器类的空格 例如 OC的字典
SpacesInContainerLiterals: true
#缩进
IndentWrappedFunctionNames: true
#在block从空行开始
KeepEmptyLinesAtTheStartOfBlocks: true
#在构造函数初始化时按逗号断行，并以冒号对齐
BreakConstructorInitializersBeforeComma: true
#函数参数换行
AllowAllParametersOfDeclarationOnNextLine: true
#括号后添加空格
SpaceAfterCStyleCast: true
#tab键盘的宽度
TabWidth: 4
UseTab: Never

</code></pre>

<ol>
<li>Linux 动态库符号导出
<br /></li>
</ol>

<p>-fvisibility=hidden</p>

<blockquote>
<p>gcc 在链接时设置 -fvisibility=hidden ，则不加 visibility 声明的都默认为 hidden ;
  gcc 默认设置 -fvisibility=default，即全部可见；
  在 gcc 中加了这个设置之后表示所有的函数都是对外不可见了，
  然后在代码里面对于想公开的函数加上 <strong>attribute</strong>((visibility(&ldquo;default&rdquo;)))</p>
</blockquote>

<pre><code>#if defined _WIN32 || defined __CYGWIN__
  #ifdef BUILDING_DLL
    #ifdef __GNUC__
      #define DLL_PUBLIC __attribute__((dllexport))
    #else
      #define DLL_PUBLIC __declspec(dllexport) // Note: actually gcc seems to also supports this syntax.
    #endif
  #else
    #ifdef __GNUC__
      #define DLL_PUBLIC __attribute__((dllimport))
    #else
      #define DLL_PUBLIC __declspec(dllimport) // Note: actually gcc seems to also supports this syntax.
  #endif
  #define DLL_LOCAL
#else
  #if __GNUC__ &gt;= 4
    #define DLL_PUBLIC __attribute__ ((visibility(&quot;default&quot;)))
    #define DLL_LOCAL  __attribute__ ((visibility(&quot;hidden&quot;)))
  #else
    #define DLL_PUBLIC
    #define DLL_LOCAL
  #endif
#endif
</code></pre>

<ol>
<li>Linux 动态库路径</li>
</ol>

<p>编译时添加RPATH</p>

<blockquote>
<p>-Wl,-rpath=./</p>
</blockquote>

<p>将链接库的目录添加到/etc/ld.so.conf文件中</p>

<p>设置运行是路径</p>

<blockquote>
<p>export LD_LIBRARY_PATH=/opt/gtk/lib:$LD_LIBRARY_PATH</p>
</blockquote>

<p>从当前动态库找符号调用,避免调用到其他库的同名符号</p>

<blockquote>
<p>-Wl,-Bsymbolic</p>
</blockquote>

                </section>
            </article>
            
            
            
            

            

            

            
    
            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://github.com/alenstar">
        <i class="fa fa-github-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2018 <i class="fa fa-heart" aria-hidden="true"></i> alenstar
    
    </p>
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

        </section>
	</div>

	

        <script src="https://alenstar.github.io/js/jquery-2.2.4.min.js"></script>
<script src="https://alenstar.github.io/js/main.js"></script>
<script src="https://alenstar.github.io/js/highlight.min.js"></script>



<script>hljs.initHighlightingOnLoad();</script>









    </body>
</html>
